name: Build arc42 PDF

on:
  push:
    branches:
      [ "master" ]
permissions:
  contents: write

jobs:
  build-pdf:
    runs-on: ubuntu-latest

    steps:

      - name: Checkout repo
        uses: actions/checkout@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}

      - name: Instalar Marp
        run: npm install -g @marp-team/marp-cli

      - name: Generar PDF con Marp
        run: |
            marp docs/arc42/arc42.md \
            --pdf \
            --allow-local-files \
            --output docs/arc42/arc42.pdf \
            --theme docs/arc42/style.css

      - name: Commit & Push PDF
        run: |
            git config --global user.name "github-actions[bot]"
            git config --global user.email "github-actions[bot]@users.noreply.github.com"
            git add docs/arc42/arc42.pdf
            git commit -m "chore(docs): update arc42.pdf [skip ci]" || echo "No changes to commit"
            git push    